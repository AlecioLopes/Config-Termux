#!/data/data/com.termux/files/usr/bin/bash

# Cores para melhor visualização
RED='\033[1;31m'
GREEN='\033[1;32m'
YELLOW='\033[1;33m'
BLUE='\033[1;34m'
CYAN='\033[1;36m'
NC='\033[0m' # No Color

# Configurações
REPO_URL="https://github.com/seu-usuario/seu-repositorio.git"
INSTALL_DIR="$HOME/termux-setup"

# Função para exibir cabeçalho
header() {
    clear
    echo -e "${CYAN}"
    echo "===================================="
    echo "  CONFIGURAÇÃO COMPLETA DO TERMUX   "
    echo "  (Versão GitHub)                  "
    echo "===================================="
    echo -e "${NC}"
}

# Função para verificar e instalar dependências
check_dependencies() {
    echo -e "${YELLOW}[*] Verificando dependências...${NC}"
    
    if ! command -v git &> /dev/null; then
        echo -e "${BLUE}[-] Git não encontrado. Instalando...${NC}"
        pkg install -y git
    fi
    
    echo -e "${GREEN}[+] Dependências verificadas.${NC}"
}

# Função para clonar repositório
clone_repo() {
    echo -e "${YELLOW}[*] Clonando repositório...${NC}"
    
    if [ -d "$INSTALL_DIR" ]; then
        echo -e "${BLUE}[-] Diretório já existe. Atualizando...${NC}"
        cd "$INSTALL_DIR" && git pull
    else
        git clone "$REPO_URL" "$INSTALL_DIR"
    fi
    
    if [ $? -ne 0 ]; then
        echo -e "${RED}[!] Erro ao clonar/atualizar repositório.${NC}"
        exit 1
    fi
    
    echo -e "${GREEN}[+] Repositório clonado/atualizado com sucesso.${NC}"
}

# Função principal
main() {
    header
    check_dependencies
    clone_repo
    
    # Executar scripts do repositório
    cd "$INSTALL_DIR"
    
    # Verificar e executar o script principal
    if [ -f "setup_termux.sh" ]; then
        echo -e "${YELLOW}[*] Executando script principal...${NC}"
        chmod +x setup_termux.sh
        ./setup_termux.sh
    else
        echo -e "${RED}[!] Script principal não encontrado no repositório.${NC}"
        exit 1
    fi
    
    echo -e "${GREEN}"
    echo "===================================="
    echo "  CONFIGURAÇÃO CONCLUÍDA COM SUCESSO"
    echo "===================================="
    echo -e "${NC}"
    
    echo -e "${YELLOW}[!] Recomenda-se reiniciar o Termux para aplicar todas as alterações.${NC}"
}

# Executar função principal
main
